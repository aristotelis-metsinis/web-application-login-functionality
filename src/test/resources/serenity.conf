# Various preferences
untrusted.certificates=true
refuse.untrusted.certificates = false
json.pretty.printing = true

# Webdriver default preferences
webdriver {
    use.driver.service.pool = false
    autodownload = false
    timeout {
        implicitlywait = 10
    }
}

# We can choose the mvn build browser related environment using -Denvironment mvn argument
environments {
    all {
        webdriver {
            base.url = "https://practicetestautomation.com/practice-test-login"
        }
        # Drivers preferences for different platforms 
        # Serenity will automatically pick the correct driver for the current platform
        drivers {
            windows {
                webdriver.chrome.driver = src/test/resources/webdriver/windows/chromedriver.exe
                webdriver.gecko.driver = src/test/resources/webdriver/windows/geckodriver.exe
            }
            mac {
                webdriver.chrome.driver = src/test/resources/webdriver/mac/chromedriver
                webdriver.gecko.driver = src/test/resources/webdriver/mac/geckodriver
            }
            linux {
                webdriver.chrome.driver = src/test/resources/webdriver/linux/chromedriver
                webdriver.firefox.driver = src/test/resources/webdriver/linux/geckodriver
            }
        }
    }
    headless-firefox {
        webdriver {
            driver = firefox
            capabilities {
                browserName = "firefox"
                pageLoadStrategy = "normal"
                acceptInsecureCerts = true
                unhandledPromptBehavior = "dismiss"
                strictFileInteractability = true
                "moz:firefoxOptions" {
                    args = [ "-private-window","-headless" ],
                    prefs {
                        "security.ssl.enable_ocsp_stapling": false,
                        "javascript.options.showInConsole": false,                        
                    },
                    log {"level": "info"},
                }
            }
        }
    }
    default-firefox {
        webdriver {
            driver = firefox
            capabilities {
                browserName = "firefox"
                pageLoadStrategy = "normal"
                acceptInsecureCerts = true
                unhandledPromptBehavior = "dismiss"
                strictFileInteractability = true
                "moz:firefoxOptions" {
                    args = [ "-private-window" ]
                    prefs {
                        "security.ssl.enable_ocsp_stapling": false,
                        "javascript.options.showInConsole": false,                        
                    },
                    log {"level": "info"},
                }
            }
        }
    }    
    headless-chrome {
        webdriver {
            driver = chrome
            capabilities {
                browserName = "chrome"
                acceptInsecureCerts = true
                "goog:chromeOptions" {
                    args = [ "--incognito", "start-maximized", "test-type", "no-sandbox", "ignore-certificate-errors", "disable-popup-blocking", "disable-default-apps", "disable-extensions", "disable-infobars", "disable-gpu", "disable-dev-shm-usage", "remote-allow-origins=*", "window-size=1920,1080", "enable-automation", "disable-browser-side-navigation", "disk-cache-size=0", "headless=new", "disable-features=DownloadBubble,DownloadBubbleV2" ]
                    prefs = {
                        "download.default_directory" = "/tmp/Downloads",
                    }
                }
            }
        }
    }
    default-chrome {
        webdriver {
            driver = chrome
            capabilities {
                browserName = "chrome"
                acceptInsecureCerts = true
                "goog:chromeOptions" {
                    args = [ "--incognito", "start-maximized", "test-type", "no-sandbox", "ignore-certificate-errors", "disable-popup-blocking", "disable-default-apps", "disable-extensions-file-access-check", "disable-infobars", "disable-gpu", "disable-dev-shm-usage", "remote-allow-origins=*", "window-size=1920,1080", "disk-cache-size=0" ]
                }
            }
        }
    }
}

# Serenity related preferences
serenity {
    take.screenshots = BEFORE_AND_AFTER_EACH_STEP
    restart.browser.for.each = scenario
    maintain.session = true
    verbose.steps = true
    reports.show.step.details = true
    logging = VERBOSE
    outputDirectory = "target/site/serenity"
    console.colors = true
    browser.maximized = true
    full.page.screenshot.strategy = true
    jquery.integration = false # Try to solve random javascript error: jQuery is not defined
    accept.insecure.certs = true
    ignore.protected.mode.settings = true
}

refuse.untrusted.certificates = false